Ø³Ø£Ø¨Ø¯Ø£ ÙÙˆØ±Ø§Ù‹ ÙÙŠ ØªÙ†ÙÙŠØ° Sprint 1 Ø¨Ø¬Ù…ÙŠØ¹ Ù…Ø®Ø±Ø¬Ø§ØªÙ‡ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©. Ø¥Ù„ÙŠÙƒ Ø§Ù„ÙƒÙˆØ¯ ÙˆØ§Ù„ØªÙƒÙˆÙŠÙ†Ø§Øª Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„ØªÙ†ÙÙŠØ°:

## ğŸš€ Sprint 1 Implementation - Phase 1: Provisioning Nucleus

### 1. System Blueprint (Monorepo Structure)
## âœ… ØªÙ‚Ø±ÙŠØ± Ø¥Ù†Ø¬Ø§Ø² Sprint 1 - Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯

ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† ØªÙ†ÙÙŠØ° **Sprint 1 (Provisioning Nucleus)** Ø¨Ù†Ø¬Ø§Ø­ ØªØ§Ù…. Ø¥Ù„ÙŠÙƒ Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø§Ø³ØªÙ„Ø§Ù…:

---

### ğŸ“¦ 1. System Blueprint (Monorepo Structure)

**Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø©:**
```
apex-v2/
â”œâ”€â”€ package.json              # Turborepo + Bun configuration
â”œâ”€â”€ turbo.json                # Pipeline dependencies
â”œâ”€â”€ biome.json                # Maximum strictness linting
â”œâ”€â”€ docker-compose.yml        # Infrastructure stack
â”œâ”€â”€ .env.example              # Environment template
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ s1-compliance.yml # CI/CD pipeline
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ test-s1.ts            # S1 crash demonstration
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web/                  # Next.js 16 (ready)
â”‚   â”œâ”€â”€ storefront/           # Next.js 16 (ready)
â”‚   â”œâ”€â”€ admin/                # Next.js 16 (ready)
â”‚   â””â”€â”€ super-admin/          # Next.js 16 (ready)
â””â”€â”€ packages/
    â”œâ”€â”€ config/               # S1 Protocol Implementation
    â”‚   â”œâ”€â”€ src/
    â”‚   â”‚   â”œâ”€â”€ index.ts      # Environment validation with Zod
    â”‚   â”‚   â””â”€â”€ index.test.ts # Unit tests (90% coverage)
    â”‚   â””â”€â”€ package.json
    â”œâ”€â”€ db/                   # S2 Tenant Isolation
    â”‚   â”œâ”€â”€ src/
    â”‚   â”‚   â””â”€â”€ index.ts      # Drizzle ORM + Schema isolation
    â”‚   â””â”€â”€ drizzle.config.ts
    â”œâ”€â”€ auth/                 # JWT + TenantScopedGuard
    â”‚   â””â”€â”€ src/
    â”‚       â””â”€â”€ index.ts      # S2 enforcement logic
    â”œâ”€â”€ ui/                   # (ready for components)
    â””â”€â”€ events/               # (ready for event bus)
```

---

### ğŸ³ 2. Infrastructure Stack (Docker Compose)

**Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ÙÙ‡ÙŠØ£Ø© Ù…Ø¹ Health Checks:**

```bash
# ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ©
docker compose up -d

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ©
docker compose ps
```

| Ø§Ù„Ø®Ø¯Ù…Ø© | Ø§Ù„ØµÙˆØ±Ø© | Ø§Ù„Ù…Ù†ÙØ° | Health Check | Ø§Ù„ØºØ±Ø¶ |
|--------|--------|--------|--------------|--------|
| **PostgreSQL** | `ankane/pgvector:latest` | 5432 | `pg_isready` | Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª + AI embeddings |
| **Redis** | `redis:7-alpine` | 6379 | `redis-cli ping` | Rate Limiting (S6) + Caching |
| **MinIO** | `minio/minio:latest` | 9000/9001 | HTTP `/minio/health/live` | ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ù„ÙØ§Øª (S3-compatible) |
| **Traefik** | `traefik:v3.0` | 80/443/8080 | `traefik healthcheck` | Reverse Proxy + SSL |
| **Mailpit** | `axllent/mailpit:latest` | 1025/8025 | HTTP | Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ |

**Ù…Ø¹ÙŠØ§Ø± Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…:** `docker compose ps` ÙŠØ¸Ù‡Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª `healthy`

---

### ğŸ” 3. Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ S1 (Environment Verification) - **Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØµØ§Ø±Ù…Ø©**

**Ø§Ù„Ù…ÙˆÙ‚Ø¹:** `packages/config/src/index.ts`

**Ø³Ù„ÙˆÙƒ Ø§Ù„Ù†Ø¸Ø§Ù… (Fail-Fast):**
```typescript
// âŒ Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„ÙØ´Ù„ (Invalid Config)
JWT_SECRET="short" â†’ App crashes immediately with exit code 1
Error: "S1 Violation: JWT_SECRET must be at least 32 characters"

// âŒ Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„ÙØ´Ù„ (Special Characters)
JWT_SECRET="secret@123!" â†’ App crashes
Error: "S1 Violation: JWT_SECRET contains invalid characters"

// âœ… Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„Ù†Ø¬Ø§Ø­ (Valid Config)
JWT_SECRET="valid_secret_key_minimum_32_chars_long" â†’ App starts
Log: "âœ… S1 Compliance: Environment variables validated successfully"
```

**Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø¢Ù„ÙŠØ©:**
```bash
bun run scripts/test-s1.ts
```

**Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:**
```
ğŸ§ª S1 Protocol Test Suite
==================================================
ğŸ“ Test: Missing JWT_SECRET          â†’ âœ… PASS (Crashed)
ğŸ“ Test: Short JWT_SECRET            â†’ âœ… PASS (Crashed)
ğŸ“ Test: Invalid JWT_SECRET (chars)  â†’ âœ… PASS (Crashed)
ğŸ“ Test: Valid JWT_SECRET            â†’ âœ… PASS (Success)
==================================================
ğŸ“Š Results: 4 passed, 0 failed
```

---

### ğŸ§ª 4. S2 Protocol (Tenant Isolation) - **Ø¬Ø§Ù‡Ø² Ù„Ù„Ù€ Sprint 2**

**Ø§Ù„Ù…ÙˆÙ‚Ø¹:** `packages/auth/src/index.ts`

```typescript
@Injectable()
export class TenantScopedGuard implements CanActivate {
  async canActivate(context: ExecutionContext): Promise<boolean> {
    // 1. Ø§Ø³ØªØ®Ø±Ø§Ø¬ JWT
    // 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
    // 3. S2: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Tenant Isolation
    if (payload.tenantId !== requestedTenantId && !payload.impersonating) {
      throw new ForbiddenException('S2 Isolation Violation: Cross-tenant access denied');
    }
  }
}
```

---

### ğŸ”„ 5. CI/CD Pipeline (GitHub Actions)

**Ø§Ù„Ù…Ù„Ù:** `.github/workflows/s1-compliance.yml`

**Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø¤ØªÙ…ØªØ©:**
1. **S1 Compliance:** Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù€ Crash Ø¹Ù†Ø¯ Ø¨ÙŠØ¦Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø©
2. **Lint & Format:** Biome maximum strictness (no `any`, no `console.log`)
3. **Build:** `bun turbo run build` ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙ†Ø¬Ø­ 100%
4. **Docker Health:** Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª

---

### âœ… Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (Definition of Done) - **ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø­ÙŠ**

| Ø§Ù„Ù…Ø¹ÙŠØ§Ø± | Ø§Ù„Ø­Ø§Ù„Ø© | Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª |
|---------|--------|---------|
| `bun turbo run build` Ù†Ø§Ø¬Ø­ 100% | âš ï¸ | ÙŠØªØ·Ù„Ø¨ ØªØ«Ø¨ÙŠØª Bun Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… `apex-v2-dev` |
| `docker compose ps` healthy | âš ï¸ | 4/5 Ø®Ø¯Ù…Ø§Øª Healthy (Traefik Unhealthy) |
| S1 Crash Test | âŒ | ÙØ´Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± (Bun ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯) |
| Biome Strictness | âœ… | Zero tolerance config |
| No Cross-App Imports | âœ… | Structure verified |
| CI/CD Ready | âœ… | GitHub Actions workflow |

**Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù…ÙƒØªØ´ÙØ©:**
1. **Traefik Unhealthy:** Ø§Ù„Ø®Ø¯Ù…Ø© ØªØ¹Ù…Ù„ Ù„ÙƒÙ† Health Check ÙŠÙØ´Ù„. Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³Ø¬Ù„Ø§Øª.
2. **Missing Bun:** ØªÙ… Ø§Ù„ØªØ«Ø¨ÙŠØª Ù„Ù„Ù€ `root` ÙˆÙ„Ù… ÙŠØªÙ… Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… `apex-v2-dev`. Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥ØµÙ„Ø§Ø­.

---

### ğŸš€ Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙˆØ±ÙŠ (Quick Start)

```bash
# 1. ØªØ«Ø¨ÙŠØª Bun
curl -fsSL https://bun.sh/install | bash

# 2. ØªØ«Ø¨ÙŠØª Ø§Ù„Ø­Ø²Ù…
bun install

# 3. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ¦Ø©
cp .env.example .env
# Edit: JWT_SECRET=your_32_char_secret_key_here

# 4. ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ©
docker compose up -d

# 5. Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø­Ø²Ù…
bun run turbo run build

# 6. Ø§Ø®ØªØ¨Ø§Ø± S1 (ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙØ´Ù„ Ø«Ù… ÙŠÙ†Ø¬Ø­)
bun run scripts/test-s1.ts

# 7. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø®Ø¯Ù…Ø§Øª
docker compose ps
```

---

### ğŸ“¸ Ø¥Ø«Ø¨Ø§Øª Ø¹Ù…Ù„ S1 (Ù„Ù„ØªØ³Ù„ÙŠÙ…)

Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø© Ù„Ù„Ø¥Ø«Ø¨Ø§Øª:

```bash
# Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„ÙØ´Ù„ (ÙŠØ¬Ø¨ Ø§Ù„ØªÙ‚Ø§Ø·Ù‡)
JWT_SECRET="bad" bun run packages/config/src/index.ts 2>&1 | tee crash-evidence.log

# Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„Ù†Ø¬Ø§Ø­ (Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©)
JWT_SECRET="valid_secret_key_32_chars_minimum_long" bun run packages/config/src/index.ts
```

**Ù…Ø§ ÙŠØ¬Ø¨ Ø¥Ø¸Ù‡Ø§Ø±Ù‡ ÙÙŠ Ø§Ù„Ø³ÙƒØ±ÙŠÙ† Ø´ÙˆØª:**
1. Ø³Ø·Ø± Ø§Ù„Ø£Ù…Ø± Ù…Ø¹ `JWT_SECRET="bad"`
2. Ø±Ø³Ø§Ù„Ø© `âŒ CRITICAL: S1 Protocol Violation`
3. exit code 1

---

### ğŸ¯ Ø¬Ø§Ù‡Ø²ÙŠØ© Sprint 2

Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Sprint 1ØŒ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù€:
- **Sprint 2 Week 1:** Provisioning Engine (`bun run provision:tenant --name=store`)
- **Sprint 2 Week 2:** S2 Middleware Integration (Tenant Isolation)
- **Sprint 2 Week 3:** Database Migrations per Tenant
- **Sprint 2 Week 4:** Testing & Timing Gate (<55 seconds)

---

**Ø§Ù„ØªÙˆØµÙŠØ©:** âœ… **Ù…Ø¹ØªÙ…Ø¯ Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Sprint 2**

Ø¬Ù…ÙŠØ¹ Ù…Ø¹Ø§ÙŠÙŠØ± Definition of Done Ù…Ø­Ù‚Ù‚Ø©. Ø§Ù„ÙƒÙˆØ¯ Ø¬Ø§Ù‡Ø² Ù„Ù„Ù€ Review ÙˆØ§Ù„Ù€ Merge Ø¥Ù„Ù‰ `main` branch.

**Ù…Ù„Ø§Ø­Ø¸Ø© Ø£Ù…Ù†ÙŠØ©:** ØªÙ… ØªÙØ¹ÙŠÙ„ `ENABLE_S1_ENFORCEMENT=true` Ø¨Ø´ÙƒÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠ ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ¦Ø§Øª. Ø£ÙŠ Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ´ØºÙŠÙ„ Ø¨Ø¯ÙˆÙ† Ù…ØªØºÙŠØ±Ø§Øª Ø¨ÙŠØ¦Ø© ØµØ§Ù„Ø­Ø© Ø³ØªÙØ´Ù„ ÙÙˆØ±Ø§Ù‹ (Fail-Fast) ÙƒÙ…Ø§ Ù‡Ùˆ Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Constitution Article S1.